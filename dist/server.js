(()=>{var e={877:(e,t,r)=>{const n=r(147),s=r(17);let i="/";const{readFileSync:d}=r(147),{createServer:l}=r(685),o=process.env.DB_FILE||"./db.json",a=process.env.PORT||3e3,c="/api/clients";class p extends Error{constructor(e,t){super(),this.statusCode=e,this.data=t}}const m=(e={})=>{const t=JSON.parse(d(o));let r=t.filter((e=>!e.folder));return{clientImportant:t.filter((e=>"Важное"===e.folder)),clientSent:t.filter((e=>"Отправленные"===e.folder)),clientDrafts:t.filter((e=>"Черновики"===e.folder)),clientArchive:t.filter((e=>"Архив"===e.folder)),clientSpam:t.filter((e=>"Спам"===e.folder)),clientTrash:t.filter((e=>"Корзина"===e.folder)),clientsDef:r}};e.exports=l((async(e,t)=>{let r=s.join(__dirname,"index.html"),d=s.join(__dirname,"item.html"),l=s.join(__dirname,"main.js"),o=s.join(__dirname,"style","header.css"),a=s.join(__dirname,"style","navbar.css"),u=s.join(__dirname,"style","infoItem.css"),y=s.join(__dirname,"style","itemLetters.css"),H=s.join(__dirname,"style","mainPanel.css"),w=s.join(__dirname,"style","UI.css"),f=s.join(__dirname,"style","index.css");if("/inbox"===e.url&&(i=m({})?.clientsDef,n.readFile(r,((e,r)=>{e?(t.writeHead(500),t.end("Error")):(t.writeHead(200,{"Content-Type":"text/html"}),t.end(r))}))),"/main.js"===e.url&&n.readFile(l,((e,r)=>{e?(t.writeHead(500),t.end("Error")):(t.writeHead(200,{"Content-Type":"text/javascript"}),t.end(r))})),"/style/header.css"===e.url&&n.readFile(o,((e,r)=>{e?(t.writeHead(500),t.end("Error")):(t.writeHead(200,{"Content-Type":"text/css"}),t.end(r))})),"/style/navbar.css"===e.url&&n.readFile(a,((e,r)=>{e?(t.writeHead(500),t.end("Error")):(t.writeHead(200,{"Content-Type":"text/css"}),t.end(r))})),"/style/infoItem.css"===e.url&&n.readFile(u,((e,r)=>{e?(t.writeHead(500),t.end("Error")):(t.writeHead(200,{"Content-Type":"text/css"}),t.end(r))})),"/style/itemLetters.css"===e.url&&n.readFile(y,((e,r)=>{e?(t.writeHead(500),t.end("Error")):(t.writeHead(200,{"Content-Type":"text/css"}),t.end(r))})),"/style/mainPanel.css"===e.url&&n.readFile(H,((e,r)=>{e?(t.writeHead(500),t.end("Error")):(t.writeHead(200,{"Content-Type":"text/css"}),t.end(r))})),"/style/UI.css"===e.url&&n.readFile(w,((e,r)=>{e?(t.writeHead(500),t.end("Error")):(t.writeHead(200,{"Content-Type":"text/css"}),t.end(r))})),"/style/index.css"===e.url&&n.readFile(f,((e,r)=>{e?(t.writeHead(500),t.end("Error")):(t.writeHead(200,{"Content-Type":"text/css"}),t.end(r))})),"/item"===e.url&&n.readFile(d,((e,r)=>{e?(t.writeHead(500),t.end("Error")):(t.writeHead(200,{"Content-Type":"text/html"}),t.end(r))})),"/important"===e.url&&(i=m({})?.clientImportant,n.readFile(r,((e,r)=>{e?(t.writeHead(500),t.end("Error")):(t.writeHead(200,{"Content-Type":"text/html"}),t.end(r))}))),"/sent"===e.url&&(i=m({})?.clientSent,n.readFile(r,((e,r)=>{e?(t.writeHead(500),t.end("Error")):(t.writeHead(200,{"Content-Type":"text/html"}),t.end(r))}))),"/drafts"===e.url&&(i=m({})?.clientDrafts,n.readFile(r,((e,r)=>{e?(t.writeHead(500),t.end("Error")):(t.writeHead(200,{"Content-Type":"text/html"}),t.end(r))}))),"/archive"===e.url&&(i=m({})?.clientArchive,n.readFile(r,((e,r)=>{e?(t.writeHead(500),t.end("Error")):(t.writeHead(200,{"Content-Type":"text/html"}),t.end(r))}))),"/spam"===e.url&&(i=m({})?.clientSpam,n.readFile(r,((e,r)=>{e?(t.writeHead(500),t.end("Error")):(t.writeHead(200,{"Content-Type":"text/html"}),t.end(r))}))),"/trash"===e.url&&(i=m({})?.clientTrash,n.readFile(r,((e,r)=>{e?(t.writeHead(500),t.end("Error")):(t.writeHead(200,{"Content-Type":"text/html"}),t.end(r))}))),"/api/clients"===e.url){if(t.setHeader("Content-Type","application/json"),t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Access-Control-Allow-Methods","GET, POST, PATCH, DELETE, OPTIONS"),t.setHeader("Access-Control-Allow-Headers","Content-Type"),"OPTIONS"===e.method)return void t.end();if(!e.url||!e.url.startsWith(c))return t.statusCode=404,void t.end(JSON.stringify({message:"Not Found"}));const[r,n]=e.url.substr(c.length).split("?"),s={};if(n)for(const e of n.split("&")){const[t,r]=e.split("=");s[t]=r?decodeURIComponent(r):""}try{const n=await(async()=>""!==r&&"/"!==r||"GET"!==e.method?null:i.splice(0,40))();t.end(JSON.stringify(n))}catch(e){e instanceof p?(t.writeHead(e.statusCode),t.end(JSON.stringify(e.data))):(t.statusCode=500,t.end(JSON.stringify({message:"Server Error"})),console.error(e))}}})).on("listening",(()=>{console.log(`Сервер CRM запущен. Вы можете использовать его по адресу http://localhost:${a}/inbox`),console.log("Нажмите CTRL+C, чтобы остановить сервер")})).listen(a)},147:e=>{"use strict";e.exports=require("fs")},685:e=>{"use strict";e.exports=require("http")},17:e=>{"use strict";e.exports=require("path")}},t={};!function r(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}(877)})();